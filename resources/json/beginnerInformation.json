{
  "introductionContent": "ddgRADer was developed to make designing double-digest restriction site associated DNA sequencing (ddRADseq) experiments more efficient and accessible. It helps the user choose the pair of enzymes, size selection cutoffs, and number of samples to be multiplexed per lane, while maximizing sequencing efficiency (by minimizing adaptor contamination and overlapping read pairs). Depending on the user-provided reference genome sequence and desired study design, ddgRADer gives recommendations of enzyme pairs or allows the user to explore enzyme pairs of their choice. The user can also try out different size selection parameters for any given enzyme pair and predict the expected number of loci (SNPs) and the sequencing efficiency (resulting from the predicted amount of adaptor contamination and overlapping read pairs).",
  "sequencyEffiencyOfPairedEndSequencing": "Normally, paired-end sequencing library construction protocols aim at fragment lengths that are longer than twice the read length: <img class='center' src='static/images/normalpairedend.png'/> <br> However, they often contain (inadvertently) a certain proportion of fragments that are between one and two read lengths. Such a fragment will result in a pair of reads that are partially overlapping. In the following example 50 bases of sequence data go to waste because the same genomic segment is sequenced twice: <img class='center' src='static/images/overlap.png'/> <br> Even worse, some fragments may be shorter than a single read length, resulting in both read overlap and adaptor contamination - the 3’ end of each read will contain part of the artificial Illumina adaptor sequence. In the following example 200 bases of sequencing go to waste (out of 300 bases, we obtain only 100 bases of useful information): <img class='center' src='static/images/adapterContamination.png'/> <br> Sequencing efficiency of a ddRADseq experiment can be defined as the proportion of sequenced bases that are not wasted due overlaps and contamination." ,
  "goalContent": "ddRAD sequencing is a popular, flexible, and cost-effective method for providing insights into the genetic architecture of organisms. In order to assist beginners and allow optimization of the protocol, ddgRADer conducts in silico digestion of the genome, predicts the number of SNPs that can be obtained, and estimates sequencing efficiency. Many ddRADseq experiments end up wasting a large proportion of the sequencing effort due to unintended read overlaps and adaptor contamination. In an empirical comparative study (Lajmi et al.), we observed a large proportion of adaptor contamination and read overlaps despite the use of size selection methods (e.g. using the Bluepippin instrument). The conclusions of that study are used by ddgRADer to make predictions. Different candidate enzyme pairs can be compared in terms of the number of genomic bases that would be sequenced, the number of samples multiplexable, and the expected level of adaptor contamination and read overlaps. Based on the experience of the user, there are two usage modes as explained below.",
  "noIdea": "ddgRADer will suggest pairs out of commonly used restriction enzymes that should be suitable for the genome uploaded by the user and the desired study design. We chose EcoRI, PstI, SbfI and SphI as rare cutters. With EcoRI the most common frequent cutters were MseI, MspI, SphI, SbfI and NlaIII. With PstI it was MspI, SphI, MseI and HhaI. With SbfI, EcoRI, MseI, MspI and SphI and ultimately with SphI MluCI. Based on the partner, some restriction enzyme (e.g. EcoRI) can also be used as a frequent cutter (see below). These combinations were chosen due to their frequent use in literature. ddgRADer virtually cuts the genome with every enzyme combination and predicts the number of fragments and fragment length distribution that will be produced. In the end, the up to 5 combinations are chosen that will result in the desired number of loci (SNPs). In the demographic analysis section, the amount of fragments that are closest to the request of ‘Number of SNPs to be genotyped’ (parameter in the tool). In contrast to this, in the genome scan, the relative amount of SNPs (entered in ‘Desired SNP density to be genotyped’) multiplied by the amount of bases in the genome (uploaded fasta file). In both cases, rare cutters are excluded if the product of the amount of their cuts and the expected SNP density is less than the given SNP amount. The resulting 5 pairs are shown, starting from the pair with the closest amount of cuts (first one) to the threshold.",
  "lemmeTryOut": "Here, the user is able to compare different enzyme pairs with each other, try out combinations and optimize their choice by also entering sequencing parameters. The user just has to enter the pairs in the choice fields and can extend their limit of choice by pressing on the + symbol. The sequencing calculation is optional. The tool cuts the uploaded genome with the chosen enzyme pairs and, if given, calculates the sequencing effort as described in Lajmi et al..",
  "estimatingSNPIntro": "The SNP density of an organism describes the average number of  single nucleotide polymorphisms (SNPs) per kilobase of genomic sequence. The expected number of SNPs vary greatly depending on the study organism, the population sampled, and the number of samples. For example, in pedigree or linkage map analyses the number of SNPs would be smaller, as samples are from a single family, compared to phylogeographic studies that involve samples from multiple populations across the entire species range. A sample from a single location/population would have an intermediate number of SNPs, which would depend on the genetic diversity of that population (e.g. whether it has recently undergone a population bottleneck).<br>Three major factors contribute to the estimation of the SNP density:<br><ul style='margin: auto; text-align: left;'><li><b>Species</b>: Different species or even various regions within the genome have a different rate of a nucleotide substitution. For example, non-coding regions tend to have a higher substitution rate than coding sequences. These factors are determined by the recombination and mutation rate. To give an example, humans have a less rate of SNP density than amphioxus does (see below).</li><li><b>Study population (a single family (pedigree), Icelanders, or entire world); mention bottleneck/founder effect (Iceland vs. Ethiopia)</b>: The study population is an important factor for the SNP density, as different populations have different SNP densities. Choosing a single family for a pedigree analysis would result in a different SNP density than the whole population does. Also the SNP density of different populations may differ. The bottleneck effect has a crucial influence on the genomes with the populations. As the massive reduction of the population size results in a big loss of genetic variety, also the amount of SNPs within a population shrinks. With this loss of genetic variety, certain SNPs of individuals get lost, which again result in a reduction of SNPs and its density within the populations. In humans, for example the population of Iceland would have a different SNP density than the population in Ethiopia. </li><li><b>Sample size</b>: Since each individual of a sample contributes to the overall SNP density, the sample size is crucial for the SNP density of the analysis. Thus it is important to choose a representative amount of samples for the population/species.</li></ul>",
  "exampleSNPDensity": "<ul style='margin: auto; width: 35%; text-align: left;'><li>X samples of human from pop Y: 4 SNPs per kb https://doi.org/10.1093/hmg/11.17.1987</li><li>Ant:  Privman et al. 2018 ~2 SNPs per kb</li><li>Amphioxus: </li><li>Arabidopsis: 1 SNP per kb (Lu et al. 2012)</li></ul>However, the total number of SNPs depends on the size of the genome.",
  "baseCutters": "There are different kinds of cutters for enzymes, depending on the size of the restriction sites. Generally the restriction sites are 4, 6 or 8 base pairs long and often occur as palindromes. The bigger the size (8-cutter) is, the less likely it is to cut the genome and the smaller the size (4-cutter) is, the more likely it is to cut the genome. It is very common to combine a rare cutter with a frequent cutter, as the rare cutter determines the frequency of the fragments and the frequent cutter the length of the fragments. A cutter is determined as frequent or rare, depending on the other cutter used in the process. E.g. EcoRI (6-cutter) is commonly used as a rare cutter, because in many experiments it is combined with a 4-cutter (e.g. MseI). However, when used with a 8-cutter (e.g. SbfI), it is considered a frequent cutter. The combination on how to choose the right cutters is based on genome, experiment and sequencing method.",
  "gcContentRestrictionSite": "Based on the GC content, restriction sites can occur differently often. For a genome with a GC content of 50% and no dinucleotide bias, a 4-cutter is expected to cut every 256 (4^4) bases, a 6-cutter ever 4096 (4^6) bases and the 8-cutter to cut every 65536 (4^8) bases. It can be calculated by the formula (0.5 x GC)a x (0.5 x AT)b , with GC and AT the amount of GC or AT in the genome and their occurence in the respective restriction site is given through a (GC) and b (AT).",
  "overlapsContaminationContent": "Adaptor contamination: fragments shorter than the read length, part of the adaptors would be sequenced. Overlaps: During paired-end sequencing, a DNA fragment is sequenced from either end. For short fragments, this could result in sequencing a stretch of the fragment twice. As the main focus of this tool is the evaluation of overlaps and adaptor contamination during sequencing, the amount of these are important for the enzyme choice. According to our results (cite) the frequent cutter determines the length of the fragments, it is the key driver for the amount of adaptor contamination in the data which ultimately results in the wastage of sequencing. Different frequent cutters result in a different course of numbers of fragments with rising length, so some cutters produce more less sized fragments than others. Even though a size selection is applied to the sequenced data, the samples show a not ignorable amount of adapter contamination and overlaps. Enzyme pairs showing a higher skew towards fragments with lower size, tend to include more adapter contamination, even though a size selection has been applied.",
  "tableMetricsGraph": "The graph shows the number of fragments generated by insilico digestion of various fragment sizes. Different colors indicate the enzyme pairs used as indicated in the legend.",
  "tableMetricsTable": "To optimize sequencing effort, the table beneath the graph presents the theoretical expectations (“theoretical” row) as well as more realistic predictions that are based on empirical experiments (“prediction” row). The table shows the results for in silico-digestion by different choices of enzyme pairs. The theoretical expectations assume that size selection is 100% effective. The predicted values for overlaps and contamination are higher because size selection fails to exclude some of the short fragments. <br><br> In order to simplify the explanation of the calculation, it is assumed to have taken a paired read sequencing run with a read length of 150. The fragments are binned into buckets of a size of 10. <br><br> Calculation of theoretical values: <br> The basis of the calculation of the theoretical values is the amount of genomic fragments which is just calculated by summing up the fragments within the selected range of bins. The number of base pairs is then calculated by taking the highest amount of fragment within the bin. So if the bin of 10,20 would contain 3 fragments, the amount of base pairs would be 60. <br>  The maximal number multiplexable is the division of the sequencing yield with the division of the total number of genomic fragments with the desired coverage. The total amount of genomic fragments are the <br><br> <span class='center formula'>maximalNumberMultiplexable = sequencing yield amount of genomic fragments sequencing depth </span> <br> The sequence efficiency is the product of the number of samples multiplexible and the summation of all bases of all bins within the chosen range. <br><br> <span class='center formula'>sequence Efficiency =maximalNumberMultiplexable  sumBasesOfSelectedBins </span> <br> Calculation of predictions based on empirical experiments: <br> These calculations predict an additional amount of adaptor contamination and overlaps on top of the theoretical expectations. We calculate these amounts using two factors aa and ao that represent the percentage of short fragments that sneak past size selection for adaptor contamination and read overlaps, respectively (these factors were derived from experimental results). The number of fragments with adaptor contamination that size selection should exclude is the sum of the size bins up to one read length, e.g. 150bp. This number is multiplied by the factor aa to get the number of fragments that gets past size selection. If the first size selection cutoff (the position of the first slider) is less than 150, we only sum the bins up to the slider. Similarly for read overlaps, we sum the bins between 150 and 300 and then multiply by ao. If the slider is in between, then the bins are summed up to the position of the slider.<br><br> <img class='center' src='static/images/adpatorContaminationFormula.png'/> <br> <img class='center' src='static/images/overLapsFormula.png'/>  <span class='center imagesubtitle'>where aa is the adapter contamination factor, and ao is the overlap factor </span><br> The theoretical number of base pairs are calculated as follows:<br><br> the number of fragments in the intervals are multiplied by its highest fragment length, so for example if the bin of (0;10] contains 10 fragments, then the number of base pairs would be taken as 100. For the experimental value, this number is added by the product of read length and adaptor contamination times 2/3 and the number of overlaps times the read length.<br><br> <span class='center formula'> predictedSumBasesOfBin  = theorheticalSumBasesInSelectedFragmentRange +additionalAdaptorContamination*2/3  &times; read length + additional Overlaps &times; read length </span><br><br><b>Enzyme pair:</b> A pair of restriction enzyme used to digest the given genome<br> <b>No. of fragments:</b> The total number of fragments generated of 0 – 1010bp size by the insilico digestion of the given genome with a pair of restriction enzymes.<br><b>No. of base pairs:</b> Total number of basepairs that constitute the fragments generated of 0 –1010 bp in size. This is calculated as No. of fragments in a 10 bp bin x size of the largest fragment in the bin.<br><b>Estimated no. of SNPs:</b> Given the expected polymorphism and the genome size, this is the number of SNPs expected.<br><b>No. of samples multiplexed:</b> calculated based on the sequencing yield, size selection parameter and the depth required by the user. <b> This is an overestimation and must be interpreted carefully.</b><br><br><div  class='All'><span class='Fraction'><span class='Numerator'>sequencing yield</span><span class='Denominator'>total number of genomic fragments in the size selected range &times; depth</span></span></div><br><b>No. of base pairs sequenced in a lane:</b> This is the effective yield of sequencing data, after deducting adaptor contaminated regions and taking into account overlaps. <br><b>Fragments under 150 bp:</b> Fragments shorter than the read length (150 bp or 100 bp typically) are expected to have adaptor contamination. This is calculated based on the size selection criteria used. The predicted value is based on corrections from empirical data and larger than the theoretical value as smaller fragments tend to get sequenced more easily. <br><b>Fragments between 150 – 300 bp:</b> Fragments of this size range in paired-end data have overlapping reads. While this is less problematic than adaptor contamination and does not affect data quality, this could lead to less efficient sequencing. <br><b>Range adjustment:</b> This slider can be used to decide the size selection parameters given a pair of restriction enzymes. <br>As this table gives different information about the sequencing output, you can compare different pairs of restriction enzymes. The row of the enzyme pair turns red, when the given size selection does not provide the desired amount of SNPs. Based on the needs of the experiment, you can choose an optimal size selection criteria that minimizes adaptor contamination and in case of paired-end sequencing, overlaps. <br><br>For more information, please read (cite paper).",
  "howToCite": "TBA."
}